<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@kentaroimai">
    <meta name="twitter:creator" content="@kentaroimai">
    
      <meta property="og:title" content="April 2023">
    
    
    <meta property="og:site_name" content="Kentaro Imai">
    <link rel="stylesheet" href="/css/style.css">
    <link href="/css/prism-gruvbox-dark.css" rel="stylesheet">
    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Kentaro Imai">
    <title>April 2023 | Kentaro Imai</title>
  </head>
  <body>
    <div class="container">
      <header class="header">
        
          <h2 class="header__site-title"><a class="header__link" href="/">Kentaro Imai</a></h2>
        
      </header>
      <main class="main">
        
          <h1 class="main__title"><a class="main__link" href="">April 2023</a></h1>
        
        
        
        <article class="main__post post">
    <h2 class="post__title"><a class="main__link" href="/2023/04/ノートアプリのおおまかな設計段階ですでに悩んでいる/">ノートアプリのおおまかな設計段階ですでに悩んでいる</a></h2>
    <div class="post-meta">
      <time class="post-meta__date date" datetime="2023-04-21T15:45:00.000Z">Friday, 21 April 2023</time>
      <ul class="post-meta__tag-list tag-list"><li class="tag-list__tag tag"><a href="/tags/%E3%82%A2%E3%83%97%E3%83%AA%E9%96%8B%E7%99%BA/" class="tag__link">アプリ開発</a></li>
<li class="tag-list__tag tag"><a href="/tags/%E9%96%8B%E7%99%BA%E6%97%A5%E8%A8%98/" class="tag__link">開発日記</a></li>
<li class="tag-list__tag tag"><a href="/tags/OT/" class="tag__link">OT</a></li>
<li class="tag-list__tag tag"><a href="/tags/CRDT/" class="tag__link">CRDT</a></li>
<li class="tag-list__tag tag"><a href="/tags/Elixir/" class="tag__link">Elixir</a></li></ul>
    </div>
    <p>先月部屋を片付けた後、<code class="main__inline-code">Riverpod</code>をさらっと勉強したりしたが、取り立てて面白い話もない。</p>
<p>その後、サーバサイドの勉強をしていた。</p>
<p>作ろうとしているアプリはノートアプリなのでクライアントだけで完結するアプリにしても良いのだが、マルチデバイス対応をするつもりなのでやはりサーバベースで作りたい。この辺りは意見が分かれるところなのかもしれないが……。</p>
<p>もしかすると例えば<code class="main__inline-code">Realm</code>などを使って作るのが正解なのかもしれないが、<code class="main__inline-code">Realm</code>のことはよく分かっていないし、こういうコア部分をプロプライエタリなもので賄うのは怖い。</p>
<p>そういう訳で、サーバサイドを書かねばならない。</p>
<p>問題は、僕がサーバサイドのコードを書いていたのはもう10年以上前ってことで、さすがに勉強をしなおさないといけないだろう。</p>
<p>そこで、当時は<code class="main__inline-code">Ruby on Rails</code>をさわっていたが、もう随分前のことでもあるし、まっさらな気持ちでサーバサイドの技術を選ぶことにした。</p>
<p>とは言っても中々難しい。</p>
<ul>
<li>
<p>MVCやその亜種をベースにしたサーバサイドのフレームワークがいろんな言語で出ているが、その中から選ぶなら以前使っていた<code class="main__inline-code">Rails</code>を選ぶのが一番楽な気がする。</p>
</li>
<li>
<p>最近は<code class="main__inline-code">JavaScript</code>をちょっと書いていたので、そういう意味では<code class="main__inline-code">JavaScript / TypeScript</code>のサーバサイドフレームワークのいずれかを使うのも良いかもしれない。</p>
</li>
<li>
<p>一方で、実は僕には将来作りたいサービスがあって、それには<code class="main__inline-code">Elixir</code>と<code class="main__inline-code">Phoenix</code>がフィットする気がしていて、そこに繋げる意味では<code class="main__inline-code">Elixir</code>と<code class="main__inline-code">Phoenix</code>で作りたい。</p>
</li>
</ul>
<p>で、とりあえず、やって損はないだろうということで、<code class="main__inline-code">Elixir</code>の勉強をしていたのが最近の話だ。</p>
<p>ただ、今悩んでいることは、ノートの整合性保持で、ここの部分の設計をどうすべきなのか、決めきれないでいる。</p>
<p>例えばウェブアプリであれば、ユーザはおそらくオンラインだし、オフライン編集ができなくてもユーザは納得してくれるだろう。オンラインであれば、おひとり様用ウェブアプリの場合、編集後即サーバに<code class="main__inline-code">POST/PUT/PATCH</code>すれば整合性の問題はほぼ起こらないだろう。</p>
<p>逆に、スマホアプリの場合、ユーザはオフラインでノート編集できることを期待する。ということは何らかのデータの競合解消ロジックが必要になる。</p>
<p>複数人で編集する場合はもちろん整合性の問題が起きるが、そうでなくても、ひとりが複数のデバイスから編集する場合、コンフリクトが起こる可能性は高い。</p>
<p>この整合性問題を解決するための技術が<code class="main__inline-code">OT</code>(Operational Transformation：操作変換)とか<code class="main__inline-code">CRDT</code>(Conflict-free Replicated Data Type)とか呼ばれるもので、この辺の知識が全く足りていない。</p>
<p>この辺の実装は<code class="main__inline-code">JavaScript</code>で書かれているものが多い気がするので、もしかするとサーバサイドはそういうライブラリを利用して<code class="main__inline-code">JavaScript</code>で書くべきなのかもしれない（折角<code class="main__inline-code">Elixir</code>の勉強をしていたところではあるが）。</p>
<p>ということで、サーバサイドを何で書くかということすら未だ確定できていないのである。</p>
<p>とりあえず、泥縄ではあるが、今から<code class="main__inline-code">OT</code>や<code class="main__inline-code">CRDT</code>の勉強をしようと思う。ただ、例えば<code class="main__inline-code">CRDT</code>と言ってもいろんなやり方が提案されているらしいので、それらの中から自分のアプリに合ったものを選ぶ必要がある。</p>
<p>もし詳しい人がいたら、何らか情報をもらえると嬉しいです。</p>
<p>あと、あんまり大変なようなら、とりあえずは個人使用を想定したノートアプリなのだから、競合解消ロジックなしで一旦リリースしてから考えるということも考えてはいる。</p>

  </article><article class="main__post post">
    <h2 class="post__title"><a class="main__link" href="/2023/04/部屋を片付けた話/">部屋を片付けた話</a></h2>
    <div class="post-meta">
      <time class="post-meta__date date" datetime="2023-04-01T06:00:00.000Z">Saturday, 1 April 2023</time>
      <ul class="post-meta__tag-list tag-list"><li class="tag-list__tag tag"><a href="/tags/%E9%9B%91%E8%A8%98/" class="tag__link">雑記</a></li>
<li class="tag-list__tag tag"><a href="/tags/%E9%96%8B%E7%99%BA%E6%97%A5%E8%A8%98/" class="tag__link">開発日記</a></li></ul>
    </div>
    <p>先月、Flutterの本を読んだ後、部屋を片付けた。</p>
<p>僕はやっぱり生活が苦手な気がする。</p>
<p>大学生だった頃に薄々気付いてはいたのだが、おっさんとなった今も何にも変わっていない。</p>
<p>片付けは苦手だし、そもそもきっちりと間違いなく何かをすることが苦手である。書き間違えずに文字を紙に書くことが苦手だし、数を数えることも苦手だ。出掛ける前に何度も忘れ物に気づいて行ったり来たりするし、出掛けてもしばしば戻って鍵が閉まっているか確認するし、結局忘れ物があったりする。日常生活のほとんどが苦手な気がしている。</p>
<p>本やPCに囲まれて過ごすのが好きな僕は、断捨離やミニマリストが話題になった頃、全く自分に関係ないものと思っていたし、正直なところ今も断捨離という言葉は好きな言葉ではない（僕は物欲肯定派である）が、今回片付けをしているうちに、少しそういうものから学ぶべきなのかもしれないと初めて思った。</p>
<p>自分の大切に思っていることに物もお金も時間も最大限投入するために、その他をできるだけ切り捨てるのだ。生活というものを極限まで自分から取り除くと、生活が苦手であるということの悪影響を最小限に抑えられるかもしれない。</p>
<p>そんなことが頭に浮かんだりした。</p>
<p>でもとりあえずは何もしない。部屋は片付いたのだ。苦手な生活のことは当分考えたくない。</p>
<p>それに、部屋は片付いたがアプリは全くできていない。</p>
<p>今月からはアプリ開発に集中したい。</p>

  </article>
      </main>
      <nav class="menu" id="main-menu">
        <button class="menu__toggle" id="menu__toggle">
          toggle menu
        </button>
        <div class="menu__dropdown" id="menu__dropdown">
          <ul class="site-nav">
            <li class="site-nav__item"><a class="site-nav__link" href="/archive/">Archive</a></li>
            <li class="site-nav__item"><a class="site-nav__link" href="/projects/">Projects</a></li>
            <li class="site-nav__item"><a class="site-nav__link" href="/feed/">Feed</a></li>
            <li class="site-nav__item"><a class="site-nav__link" href="/about/">About</a></li>
          </ul>
          <ul class="tag-cloud"><li class="tag-cloud__tag tag"><a href="/tags/CRDT/" class="tag__link" data-weight="5">CRDT</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/Dart/" class="tag__link" data-weight="9">Dart</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/Elixir/" class="tag__link" data-weight="5">Elixir</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/Flutter/" class="tag__link" data-weight="9">Flutter</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/OT/" class="tag__link" data-weight="5">OT</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/%E3%82%A2%E3%83%97%E3%83%AA%E9%96%8B%E7%99%BA/" class="tag__link" data-weight="9">アプリ開発</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/%E6%8A%80%E8%A1%93%E6%9B%B8/" class="tag__link" data-weight="9">技術書</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/%E9%96%8B%E7%99%BA%E6%97%A5%E8%A8%98/" class="tag__link" data-weight="10">開発日記</a></li>
<li class="tag-cloud__tag tag"><a href="/tags/%E9%9B%91%E8%A8%98/" class="tag__link" data-weight="5">雑記</a></li></ul>
          
            <!-- related navigation -->
          
        </div>
      </nav>
      <footer class="footer">
        <p class="footer__paragraph">
        Built with <a class="footer__link" href="https://www.11ty.dev/">Eleventy</a>. Theme colors are taken from <a class="footer__link" href="https://github.com/morhetz/gruvbox">gruvbox</a> by <a class="footer__link" href="https://github.com/morhetz">Pavel Pertsev</a>.
        </p>
        <p class="footer__paragraph">
          Copyright © 2011–2023 Kentaro Imai
        </p>
      </footer>
    </div>
    <script defer>
      var button = document.getElementById("menu__toggle");
      button.addEventListener("click", function(event) {
        event.preventDefault();
        var menu = document.getElementById("menu__dropdown");
        menu.classList.toggle("menu__dropdown--open");
      });
    </script>
  </body>
</html>
